sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment"],function(e,t){"use strict";return e.extend("com.app.artihcus.controller.BaseController",{getRouter:function(){return this.getOwnerComponent().getRouter()},onInit:function(){this.applyStoredProfileImage()},createData:function(e,t,a){return new Promise((r,s)=>{e.create(a,t,{refreshAfterChange:true,success:function(e){r(e)},error:function(e){s(e)}})})},deleteData:function(e,t){return new Promise((a,r)=>{e.remove(t,{success:function(e){a(e)},error:function(e){r(e)}})})},updateData:function(e,t,a){return new Promise((r,s)=>{e.update(a,t,{success:function(e){r(e)},error:function(e){s(e)}})})},readData:function(e,t,a){return new Promise((r,s)=>{e.read(t,{filters:[a],success:function(e){r(e)},error:function(e){s(e)}})})},loadFragment:async function(e){const a=await t.load({id:this.getView().getId(),name:`com.app.artihcus.fragment.${e}`,controller:this});this.getView().addDependent(a);return a},onPressAvatarPopOverBaseFunction:function(e,t){debugger;var a=this;var r=this.getView();var s=this.getOwnerComponent().getModel();s.read("/RESOURCESSet('"+this.ID+"')",{success:function(t){if(t.Users.toLowerCase()==="resource"){var s={Name:t.Resourcename,Number:t.Phonenumber};var o=new sap.ui.model.json.JSONModel(s);if(!a._oPopover){a._oPopover=sap.ui.xmlfragment("com.app.artihcus.fragment.ProfileDialog",a);r.addDependent(a._oPopover)}a._oPopover.setModel(o,"profile");a._oPopover.openBy(e.getSource())}else{sap.m.MessageToast.show("User is not a resource.")}},error:function(){sap.m.MessageToast.show("User does not exist")}})},onPressAccountDetails:async function(){const e=this.getOwnerComponent().getModel();const t=this.ID;await new Promise((a,r)=>{e.read(`/RESOURCESSet('${t}')`,{success:function(e){const t=e;const r=new sap.ui.model.json.JSONModel(t);this.getView().setModel(r,"oUserModel");a()}.bind(this),error:function(){MessageToast.show("Error loading user tiles");r()}})});if(!this.UserDetailsFragment){this.UserDetailsFragment=await this.loadFragment("UserDetails")}this.UserDetailsFragment.open();this.applyStoredProfileImage()},onPressDeclineProfileDetailsDailog:function(){if(this.UserDetailsFragment){this.UserDetailsFragment.close()}},onPressPopoverProfileImageAvatar:function(){var e=this;var t=document.createElement("input");t.type="file";t.accept="image/*";t.style.display="none";t.addEventListener("change",t=>{var a=t.target.files[0];if(a){var r=new FileReader;r.onload=t=>{var a=t.target.result;localStorage.removeItem("userProfileImage");e.updateAllAvatarImages(a);localStorage.setItem("userProfileImage",a);sap.m.MessageToast.show("Profile image updated successfully!")};r.readAsDataURL(a)}else{sap.m.MessageToast.show("Please select an image to upload.")}});t.click()},onPressUploadProfilePic:function(){var e=this;var t=document.createElement("input");t.type="file";t.accept="image/*";t.style.display="none";t.addEventListener("change",t=>{var a=t.target.files[0];if(a){var r=new FileReader;r.onload=t=>{var a=t.target.result;localStorage.removeItem("userProfileImage");e.updateAllAvatarImages(a);localStorage.setItem("userProfileImage",a);sap.m.MessageToast.show("Profile image updated successfully!")};r.readAsDataURL(a)}else{sap.m.MessageToast.show("Please select an image to upload.")}});t.click()},updateAllAvatarImages:function(e){var t=this;var a=t.getView();var r=a.findElements(true,function(e){return e.isA("sap.m.Avatar")});r.forEach(function(t){t.setSrc(e)})},onPressDeleteProfilePic:function(){this.clearAllAvatarImages();localStorage.removeItem("userProfileImage");sap.m.MessageToast.show("Profile image removed successfully!")},clearAllAvatarImages:function(){var e=this;var t=e.getView();var a=t.findElements(true,function(e){return e.isA("sap.m.Avatar")});a.forEach(function(e){e.setSrc("")});window.location.reload()}})});
//# sourceMappingURL=BaseController.js.map